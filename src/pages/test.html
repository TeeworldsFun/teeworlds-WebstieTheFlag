<!doctype html>
<html lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

	<title>Hello, world!</title>
</head>

<body>
	<div class="mb-3">
		<label for="exampleFormControlInput1" class="form-label">Server IP</label>
		<input type="ip" id="ip" class="form-control" placeholder="95.179.163.145:8304">
	</div>
	<div class="mb-3">
		<label for="exampleFormControlInput1" class="form-label">Nickname</label>
		<input type="ip" id="name" class="form-control" placeholder="haxxor1337">
	</div>
	<div class="mb-3">
		<label for="exampleFormControlInput1" class="form-label">Time until disconnect (in seconds)</label>
		<input type="number" id="time" class="form-control" placeholder="30">
	</div>
	<div class="mb-3">
		<label for="exampleFormControlTextarea1" class="form-label">Chat Messages
			<button type="button" class="btn btn-success" onclick="add()">+</button>
			<button type="button" onclick="remove()" class="btn btn-danger">-</button>
			<br>
			<button type="button" class="btn btn-success"
				onclick="add(`${random(nouns)} ${random(verbs)} ${random(nouns)}`)">+random crap</button>
			<button type="button" class="btn btn-success" onclick="add(random(sentences))">+random sentences</button>
		</label>
		<div id="messages">
			<!-- <div class="card-body"> -->
				<div class="input-group">
					<textarea class="form-control" id="exampleFormControlTextarea1" rows="2" maxlength="255"
						placeholder="Message" style="float:left"></textarea>
					<button type="button" class="btn btn-success" onclick="duplicate(0)"
						style="float:right">Duplicate</button>
				</div>
				<br>
			<!-- </div> -->
		</div>
	</div>
	<br>
	</div>
	</div>
	<button type="button" class="btn btn-success" onclick="send()">Send</button>
	<button type="button" class="btn btn-success" onclick="disconnect()">Disconnect</button>
	<div id="accordion">
		<div class="card">
			<div class="card-header" id="headingOne">
				<h5 class="mb-0">
					<button class="btn btn-link collapser" id="collapser-1" data-toggle="collapse"
						data-target="#collapse-1" aria-expanded="true" aria-controls="collapse-1">
						Advanced
					</button>
				</h5>
			</div>
			<div id="collapse-1" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
				<div class="card-header" id="headingOne">
					<h5 class="mb-0">
						<button class="btn btn-link collapser" id="collapser-2" data-toggle="collapse"
							data-target="#collapse-2" aria-expanded="true" aria-controls="collapse-2">
							<li>Random sentences</li>
						</button>

						<div id="collapse-2" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
							<div class="card-body">
								<table class="table">
									<thead>
										<tr>
											<th scope="col">#</th>
											<th scope="col">Message</th>
											<th scope="col">Remove Button</th>
										</tr>
									</thead>
									<tbody></tbody>
								</table>
							</div>
						</div>
					</h5>
					<div class="card-header" id="headingOne">
						<h5 class="mb-0">
							<button class="btn btn-link collapser" id="collapser-3" data-toggle="collapse"
								data-target="#collapse-3" aria-expanded="true" aria-controls="collapse-3">
								<li>Mass ping</li>
							</button>
						</h5>
					</div>
					<div id="collapse-3" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
						<div class="card-body">
							<div class="input-group">
								<textarea class="form-control" id="pings" placeholder='[13:25:13][chat]: *** flappy, Chillingo, ZillyDreck, Fluffy, MLG_PRO, Ƭevan, Shiro,, naruto, o__o, (3)Lord zebiboss, ßig Toe, Ðream, nameless tee
[13:25:13][chat]: *** (1)Kodi, nennyy, nenny, [D] ERROR, taybolo, (1)Christmass Gi, (1)ERROR, Christmass Gift, cvetan [D], Kodi, (2)Lord zebiboss
[13:25:13][chat]: *** f"{self.name}", Shiro., e, ChillerDragon, (1)naruto, ChillerDragon.*, yarrabeniğğğ, Duke Ellington, hhh3, ERROR
[13:25:13][chat]: *** Kodi(Duke[D]), Tokчo drıft, Molot, German Tee, P4Pyr0s, Swarfey, Xx_cvetan_xX, kais, Nudelsaft c:, Супер!!!!
[13:25:13][chat]: *** (1)[D] ERROR, [D] P4Pyr0s, FazTi, !Darther, oo__oo, lolpoep, Nerien, HardreenClutch, DrRichtofen⚕, DDR, GReeeN
[13:25:13][chat]: *** Lord zebiboss, (1)Lord zebiboss, Tevan, (1)Ðream' rows="7" style="float: left"></textarea>
								<button type="button" class="btn btn-success" onclick="addPings()"
									style="float:right">Add</button> </div>
						</div>
					</div>
				</div>
				<div class="card-header" id="headingOne">
					<h5 class="mb-0">
						<button class="btn btn-link collapser" id="collapser-4" data-toggle="collapse"
							data-target="#collapse-4" aria-expanded="true" aria-controls="collapse-4">
							<li>Settings</li>
						</button>
					</h5>
				</div>
				<div id="collapse-4" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
					<h5 class="mb-0">
						<div class="form-check">
							<input class="form-check-input" id="prefix-box" type="checkbox" value=""
								id="flexCheckDefault">
							<label class="form-check-label" for="flexCheckDefault">
								add prefix <input id="prefix" placeholder="/me ">
								<button type="button" class="btn btn-success" onclick="applyPrefixes()">Apply to
									all</button>
							</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" id="randomize-box" type="checkbox" value="" onchange="showForm('#random-collapse')"
								id="flexCheckDefault">
							<label class="form-check-label" for="flexCheckDefault">
								randomize names on join
							</label> 
						</div>
						<div id="random-collapse" class="d-none">
							<div class="form-check">
								<input class="form-check-input" id="gibberish-box" type="checkbox" value=""
									id="flexCheckDefault">
								<label class="form-check-label" for="flexCheckDefault">
									giberrish names
								</label> 
							</div>
							<div class="form-check">
								<input class="form-check-input" id="uppercase-box" type="checkbox" value=""
									id="flexCheckDefault">
								<label class="form-check-label" for="flexCheckDefault">
									uppercase
								</label> 
							</div>
						</div>
						<div class="form-check">
							<input class="form-check-input" id="multi-support-box" type="checkbox" value="" onchange="showForm
							('#server-list'); !document.querySelector('#server-list-inp').value ? document.querySelector('#server-list-inp').value = document.location.origin : ''"
								id="flexCheckDefault">
							<label class="form-check-label" for="flexCheckDefault">
								multi server support (split by new line)
							</label> 
						</div>
						<div id="server-list" class="d-none">
							<textarea class="form-control" id="server-list-inp"></textarea>
						</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<!-- Optional JavaScript; choose one of the two! -->

	<!-- Option 1: Bootstrap Bundle with Popper -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
	</script>

	<!-- Option 2: Separate Popper and Bootstrap JS -->
	<!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
    -->
</body>

</html>
<style>
	li {
		list-style: none;
		padding-left: 25px
	}
</style>
<script>
	function showForm(id) {
		var el = document.querySelector(id);
		el.classList.contains("d-none") ? el.classList.remove("d-none") : el.classList.add("d-none")
	}
	function registerCollapser(i) {
		document.querySelector("#collapser-" + i).onclick = () => {
			document.querySelector("#collapse-" + i).classList.contains("show") ? document.querySelector("#collapse-" +
				i).classList.remove("show") : document.querySelector("#collapse-" + i).classList.add("show")
		}
	}
	for (let i = 1; i < 5; i++) {
		registerCollapser(i)
	}
	verbs = ["killed", "deleted", "was ran over by", "10-0ed", "was lucky against"]
	nouns = ["loser", "noob", "dog", "cat", "u"]
	sentences = ["Don't masturbate, it's harmful for your family if they catch you!",
		"If her age is on the clock, she's ready for the cock!",
		"Im so gay haha i can't keep it a secret anymore sorry guys", "I suck everyon's balls for free without fee",
		"you should better rqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrqrq",
		"guys come 1vs1! I 10-0 ALL OF U!", "hey :):)))", "My cock is less than 1 inch!", "bonus noobs",
		"fokkonaut: ban the faker!", "Im getting so wet and horny, i cant stand it anymoree",
		"fokkonaut: give portal plz", "im so fucking gay, pls give me anal pls wheres the poop knife?",
		"help help help help help",
		"Holy fucking shit. I want to bang the teeworlds twinbop skin so goddamn bad. I can't stand it anymore. Every time I go to the tee menu I get a massive erection. I've seen literally every rule 34 post there is of her online.",
		"My dreams are nothing but constant fucking sex with twinbop. I'm sick of waking up every morning with six nuts in my boxers and knowing that those are nuts that should've been busted inside of twinbops's tight tee pussy. I want her to have my mutant human"
	]

	function buildSentences() {
		document.querySelector("tbody").innerHTML = ""

		sentences.forEach((element, i) => {
			/*	<tr>
					<th scope="row">1</th>
					<td>Mark</td>
					<td>Otto</td>
					<td>@mdo</td>
				</tr>
			*/

			var tr = document.createElement("tr")
			th = document.createElement("th")
			th.scope = "row"
			th.innerText = i;
			tr.appendChild(th)
			td = document.createElement("th");
			td.innerText = element;
			tr.appendChild(td);
			td = document.createElement("th");
			td.innerHTML =
				`<button type="button" class="btn btn-danger" onclick="removeSentence(${i})">Remove</button>`
			tr.appendChild(td)
			document.querySelector("tbody").appendChild(tr)
		});
		var tr = document.createElement("tr")
		th = document.createElement("th")
		th.scope = "row"
		th.innerText = sentences.length;
		tr.appendChild(th)
		td = document.createElement("th");
		td.innerHTML = `<div class="input-group">
  <textarea maxlength="255" class="form-control"></textarea>
</div>`;
		tr.appendChild(td);
		td = document.createElement("th");
		td.innerHTML = `<button type="button" class="btn btn-success" onclick="addSentence()">Add</button>`
		tr.appendChild(td)
		document.querySelector("tbody").appendChild(tr)
	}
	buildSentences()

	function removeSentence(i) {
		sentences.splice(i, 1);
		buildSentences()
	}

	function applyPrefixes() {
        children = document.querySelector("#messages").children
		prefix = document.querySelector("#prefix").value;
		Array.from(children).forEach(a => {
            if (a.tagName == "DIV")
    			a.children[0].value = prefix + a.children[0].value
		})

	}

	function addSentence() {
		children = document.querySelector("tbody").children

		sentences.push(children[children.length - 1].children[1].children[0].children[0].value)
		buildSentences()
	}

	function random(list) {
		return list[Math.floor(Math.random() * list.length)]
	}

	function remove() {
		children = document.querySelector("#messages").children;
		if (children.length > 0) {
			children[children.length - 1].outerHTML = ""
			children[children.length - 1].outerHTML = ""
		}
	}

	function add(value = "") {
		// children = document.querySelector("#messages");
		// asd = document.createElement("textarea");
		// asd.outerHTML = `<textarea class="form-control" id="exampleFormControlTextarea1" rows="2" maxlength="255" placeholder="Message"></textarea>`
		// children.appendChild(asd)
		console.log(value)
		var textEl = document.getElementById("messages");
		var input = document.createElement("textarea");
		input.className = "form-control"
		input.rows = 2;
		input.maxLength = 255;
		input.placeholder = "Message";
		// if (document.querySelector("#prefix-box").checked && value)
		// 	input.value = document.querySelector("#prefix").value + value
		// else if (value)
		// 	input.value = value;
		// input.id = "exampleFormControlTextarea1"
		// input.outerHTML = `<textarea class="form-control" id="exampleFormControlTextarea1" rows="2" maxlength="255" placeholder="Message"></textarea>`

		var div = document.createElement("div");
		var button = document.createElement("button")
		// button.type="button"
		// button.classList = "btn btn-success"
		console.log(textEl.children.length)
		// button.onclick = () => duplicate(textEl.children.length.toString())
		// button.style = "float:right"
		// button.innerText = "Duplicate"
		// button.outerHTML = `<button type="button" class="btn btn-success" onclick="duplicate(${textEl.children.length})" style="float:right">Duplicate</button>`
		// div.appendChild(button)
		
		div.appendChild(input);
		div.innerHTML += `<button type="button" class="btn btn-success" onclick="duplicate(${textEl.children.length})" style="float:right">Duplicate</button>`
		if (document.querySelector("#prefix-box").checked && value)
			div.children[0].value = document.querySelector("#prefix").value + value
		else if (value)
			div.children[0].value = value;
		// div.children[0].value = value
		div.className = "input-group"
		// div.appendChild(textEl);
		console.log(div)
		// div.className = "input-group"
		textEl.appendChild(div);
		textEl.appendChild(document.createElement("br"));
	}
	function duplicate(i) {
		var messages = document.getElementById("messages");
		console.log(i, messages.children.length, messages.children[i].children[0].value)
		var target = document.createElement("div")
		// target.className = "input-group"
		// target.innerHTML = messages.children[i].innerHTML;
		// target.children[1].remove()
		// target.innerHTML +=  `<button type="button" class="btn btn-success" onclick="duplicate(${messages.children.length})" style="float:right">Duplicate</button>`
		// target.children[0].value = messages.children[i].children[0].value
		// target.children[1].value = target.children[1].value
		// console.log(target, messages.children[i].children[0].value)
		// target.children[1].onclick = () => duplicate(messages.children.length)
		// messages.appendChild(target)
		add(messages.children[i].children[0].value)
		// messages.appendChild(document.createElement("br"))
	}
	function capitalizeFirstLetter(string) {
		return string.charAt(0).toUpperCase() + string.slice(1);
	}
	randomNum = (x) => Math.floor(Math.random()*x)
	function randomName(uppercase = false, gibberish = false) {
		abc = "abcdefghijklmnopqrstuvwxyz"
		name = ""
		if (gibberish) {
			for (let i = 0; i < 16; i++) {
				name += abc[randomNum(abc.length)]
			}
		} else {
			vocals = "aeiouy"
			consonants = "bcdfghjklmnpqrstvwxz"
			arr = [consonants, vocals]
			pattern = [[1, 0, 1, 1, 0, 1, 1], [1, 1, 0, 1, 1, 0, 0], [1, 0, 1, 1, 0, 1, 0], [1, 1, 0, 0, 1, 0, 1]] // vocal = 0; consonant = 1; max length 11; examples: sally, swarfey, pinky; greyfox
			pattern = pattern[Math.floor(Math.random()*pattern.length)]
			for (let i = 0; i < Math.floor(Math.random()*4)+3; i++) {
				var pat = arr[pattern[i]]
				console.log(i, pat[randomNum(pat.length)])
				name += pat[randomNum(pat.length)]
			}
		}
		Math.random() > 0.3 ? name = capitalizeFirstLetter(name) : "";
		uppercase ? name = name.toUpperCase() : "";
		return name;
	}
	function pack() {
		if (document.querySelector("#randomize-box").checked) {
			document.querySelector("#name").value = randomName(document.querySelector("#uppercase-box").checked, document.querySelector("#gibberish-box").checked)
		}
		return {
			"ip": document.querySelector("#ip").value ? document.querySelector("#ip").value : document.querySelector("#ip")
				.placeholder,
			"name": document.querySelector("#name").value ? document.querySelector("#name").value : document.querySelector(
				"#name").placeholder,
			"time": parseInt(document.querySelector("#time").value) ? parseInt(document.querySelector("#time").value) :
				parseInt(document.querySelector("#time").placeholder),
			"messages": Array.from(document.querySelector("#messages").children).filter(a => a.tagName == "DIV").map(a => a.children[0].value)
		}
	}

	function addPings(a = document.querySelector("#pings").value) {
		b = a.split("][chat]: *** ").map(a => a.split("\n")[0])
		b.splice(0, 1)
		pingList = []
		i = 0;
		b.map(a => a.split(", ")).flat().forEach((a, j) => {
			if (!pingList[i])
				return pingList[i] = a + ' ';
			if (pingList[i].length + a.length > 254)
				i++;
			else
				return pingList[i] += a + ' ';

			pingList[i] = a + ' ';

		})

		pingList.forEach(add)
	}

	function disconnect() {
		if (document.querySelector("#multi-support-box").checked) {
			// console.log("hi", )
			list = document.querySelector("#server-list-inp").value.split("\n")
			console.log(list);
			list.forEach(a => {
				// body = JSON.stringify(pack());
				// console.log(body);
				fetch(a + "/disconnectAll", {
					"method": "POST",
				})
			})
		} else {
			body = JSON.stringify(pack());
			console.log(body);
			fetch(document.location.origin + "/disconnectAll", {
			"method": "POST",
		})
		}

	}

	function send() {
		if (document.querySelector("#multi-support-box").checked) {
			// console.log("hi", )
			list = document.querySelector("#server-list-inp").value.split("\n")
			console.log(list);
			list.forEach(a => {
				body = JSON.stringify(pack());
				console.log(body);
				fetch(a + "/join", {
					"method": "POST",
					"body": body
				})
			})
		} else {
			body = JSON.stringify(pack());
			console.log(body);
			fetch(document.location.origin + "/join", {
				"method": "POST",
				"body": body
			})
		}
	}
</script>